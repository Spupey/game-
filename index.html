<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–£–≥–æ–ª—å–Ω—ã–π –ö–ª–∏–∫–µ—Ä</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');

  body {
    margin: 0; background: linear-gradient(135deg, #0f172a, #1e293b);
    font-family: 'Roboto Mono', monospace;
    color: #cbd5e1;
    user-select: none;
    overflow-x: hidden;
  }

  #game {
    max-width: 480px;
    margin: 12px auto;
    background: #1e293bcc;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 0 16px #38bdf8aa;
  }

  h1 {
    color: #38bdf8;
    text-align: center;
    margin-bottom: 10px;
  }

  #resources {
    display: flex;
    justify-content: space-around;
    margin-bottom: 14px;
  }
  .resource {
    background: #334155cc;
    border-radius: 12px;
    padding: 10px 14px;
    min-width: 100px;
    text-align: center;
    box-shadow: 0 0 10px #2563eb88 inset;
    transition: box-shadow 0.3s;
  }
  .resource:hover {
    box-shadow: 0 0 14px #22d3eeaa inset;
  }
  .resource span {
    font-weight: 700;
    font-size: 1.3em;
    display: block;
    margin-top: 6px;
  }

  #coalButton {
    display: block;
    margin: 0 auto 12px auto;
    width: 180px;
    height: 180px;
    background: url('https://cdn-icons-png.flaticon.com/512/2972/2972215.png') no-repeat center/contain;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 25px #0ea5e9cc;
    transition: box-shadow 0.3s, transform 0.2s;
    user-select: none;
  }
  #coalButton:active {
    transform: scale(0.93);
    box-shadow: 0 0 40px #22d3eecc;
  }

  #pickaxeSection {
    background: #334155cc;
    border-radius: 14px;
    padding: 10px 16px;
    margin-bottom: 18px;
  }
  #pickaxeSection h2 {
    color: #7dd3fc;
    margin-top: 0;
  }
  #pickaxeStats {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
  }
  #upgradePickaxeBtn {
    background: #2563eb;
    border: none;
    border-radius: 8px;
    padding: 8px 16px;
    color: white;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s;
  }
  #upgradePickaxeBtn:hover:not(:disabled) {
    background-color: #1e40af;
  }
  #upgradePickaxeBtn:disabled {
    background-color: #94a3b8;
    cursor: default;
  }

  #inventory {
    background: #334155cc;
    border-radius: 14px;
    padding: 10px 16px;
    margin-bottom: 18px;
  }
  #inventory h2 {
    color: #7dd3fc;
    margin-top: 0;
  }
  #pickaxeInventory {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
  .pickaxeSlot {
    background: #1e293bcc;
    border-radius: 10px;
    padding: 6px;
    cursor: pointer;
    box-shadow: 0 0 6px #64748b88;
    transition: box-shadow 0.2s;
    width: 60px;
    text-align: center;
  }
  .pickaxeSlot.active {
    box-shadow: 0 0 16px #22d3eecc;
    background-color: #0ea5e9bb;
  }
  .pickaxeSlot img {
    width: 40px;
    height: 40px;
    user-select: none;
  }
  .pickaxeLevel {
    font-size: 0.8em;
    margin-top: 2px;
    color: #a5b4fc;
  }

  #achievements, #quests {
    background: #111827cc;
    border-radius: 10px;
    padding: 12px;
    margin-top: 15px;
    color: #cbd5e1;
    box-shadow: 0 0 12px #7dd3fcaa;
    max-height: 200px;
    overflow-y: auto;
  }
  #achievements h2, #quests h2 {
    color: #38bdf8;
    margin-bottom: 8px;
  }
  .achievement, .quest {
    background: #1e293bcc;
    margin-bottom: 8px;
    padding: 8px;
    border-radius: 8px;
    transition: background-color 0.3s;
    cursor: default;
  }
  .achievement.completed {
    background-color: #22c55e99;
    text-decoration: line-through;
  }
  .quest.completed {
    background-color: #facc159aa;
    text-decoration: line-through;
  }
  .achievement h3, .quest h3 {
    margin: 0 0 4px 0;
    font-size: 1.1em;
  }
  .quest button {
    margin-top: 6px;
    background: #2563eb;
    border: none;
    color: white;
    border-radius: 6px;
    padding: 4px 10px;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  .quest button:hover:not(:disabled) {
    background-color: #1d4ed8;
  }
  .quest button:disabled {
    background-color: #94a3b8;
    cursor: default;
  }

  #log {
    background: #1e293bcc;
    color: #a5b4fcaa;
    font-size: 0.9em;
    height: 100px;
    overflow-y: auto;
    border-radius: 8px;
    padding: 6px 10px;
    margin-top: 18px;
  }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ */
  .click-effect {
    position: absolute;
    font-weight: 700;
    font-size: 1.3em;
    color: #22d3ee;
    user-select: none;
    pointer-events: none;
    animation: floatUp 1s ease-out forwards;
  }
  @keyframes floatUp {
    0% {opacity:1; transform: translateY(0);}
    100% {opacity:0; transform: translateY(-50px);}
  }

</style>
</head>
<body>

<div id="game">
  <h1>–£–≥–æ–ª—å–Ω—ã–π –ö–ª–∏–∫–µ—Ä</h1>

  <div id="resources">
    <div class="resource">–£–≥–æ–ª—å: <span id="coalCount">0</span></div>
    <div class="resource">–ö–∞–º–Ω–∏: <span id="stoneCount">0</span></div>
    <div class="resource">–ó–æ–ª–æ—Ç–æ–π —É–≥–æ–ª—å: <span id="goldCoalCount">0</span></div>
  </div>

  <div id="coalButton" title="–ö–ª–∏–∫–Ω–∏ –ø–æ —É–≥–ª—é!"></div>

  <div id="pickaxeSection">
    <h2>–ö–∏—Ä–∫–∞ <span id="pickaxeLevel">1</span> —É—Ä–æ–≤–µ–Ω—å</h2>
    <div id="pickaxeStats">
      <div>–£—Ä–æ–Ω: <span id="pickaxePower">1</span></div>
      <div>–°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è: <span id="upgradeCost">20 —É–≥–ª—è</span></div>
    </div>
    <button id="upgradePickaxeBtn">–£–ª—É—á—à–∏—Ç—å –∫–∏—Ä–∫—É</button>
  </div>

  <div id="inventory">
    <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∫–∏—Ä–æ–∫</h2>
    <div id="pickaxeInventory"></div>
  </div>

  <div id="achievements">
    <h2>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
    <div id="achievementList"></div>
  </div>

  <div id="quests">
    <h2>üìú –ö–≤–µ—Å—Ç—ã</h2>
    <div id="questList"></div>
  </div>

  <div id="log"></div>
</div>

<script>
(() => {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
  const state = {
    coal: 0,
    stones: 0,
    goldCoal: 0,
    pickaxeLevel: 1,
    pickaxePower: 1,
    totalClicks: 0,
    inventory: [], // —Å–ø–∏—Å–æ–∫ –∫–∏—Ä–æ–∫ —Å —É—Ä–æ–≤–Ω—è–º–∏
    activePickaxeIndex: 0,
  };

  // –ó–≤—É–∫–∏
  const sounds = {
    click: new Audio('https://freesound.org/data/previews/341/341695_5121236-lq.mp3'),
    upgrade: new Audio('https://freesound.org/data/previews/256/256113_3263906-lq.mp3'),
    achievement: new Audio('https://freesound.org/data/previews/167/167219_2437358-lq.mp3'),
  };
  sounds.click.volume = 0.15;
  sounds.upgrade.volume = 0.1;
  sounds.achievement.volume = 0.2;

  // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
  const coalCountEl = document.getElementById('coalCount');
  const stoneCountEl = document.getElementById('stoneCount');
  const goldCoalCountEl = document.getElementById('goldCoalCount');
  const pickaxeLevelEl = document.getElementById('pickaxeLevel');
  const pickaxePowerEl = document.getElementById('pickaxePower');
  const upgradeCostEl = document.getElementById('upgradeCost');
  const upgradeBtn = document.getElementById('upgradePickaxeBtn');
  const coalBtn = document.getElementById('coalButton');
  const pickaxeInventoryEl = document.getElementById('pickaxeInventory');
  const achievementList = document.getElementById('achievementList');
  const questList = document.getElementById('questList');
  const logEl = document.getElementById('log');

  // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
  function addLog(text, type='info') {
    const p = document.createElement('p');
    p.textContent = text;
    if(type === 'success') p.style.color = '#22c55e';
    else if(type === 'error') p.style.color = '#f87171';
    logEl.appendChild(p);
    logEl.scrollTop = logEl.scrollHeight;
  }

  // –°–æ–∑–¥–∞—Ç—å –∫–∏—Ä–∫—É –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  function createPickaxe(level) {
    return {
      level,
      power: 1 + (level - 1) * 0.5,
      upgradeCost: Math.floor(20 * Math.pow(1.8, level - 1))
    };
  }

  // –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∏—Ä–∫—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (–¥–ª—è –Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç 3 –∫–∏—Ä–∫–∏)
  function addPickaxeToInventory(level) {
    state.inventory.push(createPickaxe(level));
  }

  // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
  function renderInventory() {
    pickaxeInventoryEl.innerHTML = '';
    state.inventory.forEach((pickaxe, i) => {
      const slot = document.createElement('div');
      slot.className = 'pickaxeSlot' + (i === state.activePickaxeIndex ? ' active' : '');
      slot.title = `–ö–∏—Ä–∫–∞ —É—Ä–æ–≤–µ–Ω—å ${pickaxe.level}\n–£—Ä–æ–Ω: ${pickaxe.power}\n–°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è: ${pickaxe.upgradeCost} —É–≥–ª—è`;

      // –ò–∫–æ–Ω–∫–∞ –∫–∏—Ä–∫–∏ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∏—Ä–æ–∫)
      slot.innerHTML = `
        <img src="https://cdn-icons-png.flaticon.com/512/1046/1046784.png" alt="pickaxe">
        <div class="pickaxeLevel">–£—Ä–æ–≤–µ–Ω—å ${pickaxe.level}</div>
      `;

      slot.onclick = () => {
        state.activePickaxeIndex = i;
        updatePickaxeInfo();
        renderInventory();
      };

      pickaxeInventoryEl.appendChild(slot);
    });
  }

  // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ç–µ–∫—É—â–µ–π –∫–∏—Ä–∫–µ
  function updatePickaxeInfo() {
    const activePickaxe = state.inventory[state.activePickaxeIndex];
    state.pickaxeLevel = activePickaxe.level;
    state.pickaxePower = activePickaxe.power;
    upgradeCostEl.textContent = `${activePickaxe.upgradeCost} —É–≥–ª—è`;
    pickaxeLevelEl.textContent = activePickaxe.level;
    pickaxePowerEl.textContent = activePickaxe.power.toFixed(1);
    upgradeBtn.disabled = state.coal < activePickaxe.upgradeCost;
  }

  // –£–ª—É—á—à–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∏—Ä–∫—É
  function upgradePickaxe() {
    const activePickaxe = state.inventory[state.activePickaxeIndex];
    if(state.coal >= activePickaxe.upgradeCost) {
      state.coal -= activePickaxe.upgradeCost;
      activePickaxe.level++;
      activePickaxe.power = 1 + (activePickaxe.level - 1) * 0.5;
      activePickaxe.upgradeCost = Math.floor(activePickaxe.upgradeCost * 1.8);
      sounds.upgrade.play();
      addLog(`–ö–∏—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∞ –¥–æ —É—Ä–æ–≤–Ω—è ${activePickaxe.level}!`, 'success');
      updatePickaxeInfo();
      updateResources();
      checkAchievements();
      checkQuests();
    } else {
      addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–≥–ª—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∏—Ä–∫–∏', 'error');
    }
  }

  // –û–±–Ω–æ–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
  function updateResources() {
    coalCountEl.textContent = state.coal;
    stoneCountEl.textContent = state.stones;
    goldCoalCountEl.textContent = state.goldCoal;
    upgradeBtn.disabled = state.coal < state.inventory[state.activePickaxeIndex].upgradeCost;
  }

  // –ê–Ω–∏–º–∞—Ü–∏—è + –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
  function showClickEffect(x, y, text) {
    const effect = document.createElement('div');
    effect.className = 'click-effect';
    effect.style.left = x + 'px';
    effect.style.top = y + 'px';
    effect.textContent = text;
    document.body.appendChild(effect);
    setTimeout(() => effect.remove(), 1000);
  }

  // –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  const achievements = [
    { id: 'click100', title: '100 –∫–ª–∏–∫–æ–≤', desc: '–ö–ª–∏–∫–Ω–∏ –ø–æ —É–≥–ª—é 100 —Ä–∞–∑', condition: s => s.totalClicks >= 100, reward: { coal: 50 }, completed: false },
    { id: 'coal1000', title: '1000 —É–≥–ª—è', desc: '–ù–∞–∫–æ–ø–∏ 1000 —É–≥–ª—è', condition: s => s.coal >= 1000, reward: { stones: 20 }, completed: false },
    { id: 'pickaxe5', title: '–ö–∏—Ä–∫–∞ 5 —É—Ä–æ–≤–Ω—è', desc: '–£–ª—É—á—à–∏—Ç—å –∫–∏—Ä–∫—É –¥–æ 5 —É—Ä–æ–≤–Ω—è', condition: s => s.pickaxeLevel >= 5, reward: { coal: 100, stones: 30 }, completed: false },
  ];

  // –ö–≤–µ—Å—Ç—ã
  let quests = [
    { id: 'quest1', title: '–î–æ–±—É–¥—å 50 —É–≥–ª—è', desc: '–°–æ–±–µ—Ä–∏ 50 —É–≥–ª—è', target: 50, progress: 0, reward: { coal: 20 }, completed: false },
    { id: 'quest2', title: '–°–æ–≤–µ—Ä—à–∏—Ç—å 20 –∫–ª–∏–∫–æ–≤', desc: '–ö–ª–∏–∫–Ω–∏ –ø–æ —É–≥–ª—é 20 —Ä–∞–∑', target: 20, progress: 0, reward: { stones: 10 }, completed: false },
  ];

  // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  function renderAchievements() {
    achievementList.innerHTML = '';
    achievements.forEach(a => {
      const div = document.createElement('div');
      div.className = 'achievement' + (a.completed ? ' completed' : '');
      div.innerHTML = `<h3>${a.title}</h3><p>${a.desc}</p>`;
      achievementList.appendChild(div);
    });
  }

  // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–≤–µ—Å—Ç—ã
  function renderQuests() {
    questList.innerHTML = '';
    quests.forEach(q => {
      const div = document.createElement('div');
      div.className = 'quest' + (q.completed ? ' completed' : '');
      div.innerHTML = `
        <h3>${q.title}</h3>
        <p>${q.desc} (${q.progress} / ${q.target})</p>
        <button ${q.completed ? 'disabled' : ''}>–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
      `;
      if(!q.completed) {
        div.querySelector('button').onclick = () => completeQuest(q.id);
      }
      questList.appendChild(div);
    });
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
  function checkAchievements() {
    let newAchievement = false;
    achievements.forEach(a => {
      if(!a.completed && a.condition(state)) {
        a.completed = true;
        newAchievement = true;
        addLog(`–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ: ${a.title}`, 'success');
        sounds.achievement.play();
        // –í—ã–¥–∞—á–∞ –Ω–∞–≥—Ä–∞–¥—ã
        for(const [res, val] of Object.entries(a.reward)) {
          state[res] += val;
        }
        updateResources();
      }
    });
    if(newAchievement) renderAchievements();
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–µ—Å—Ç–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)
  function checkQuests() {
    quests.forEach(q => {
      if(!q.completed) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–≤–µ—Å—Ç–æ–≤
        if(q.id === 'quest1') q.progress = Math.min(q.target, state.coal);
        else if(q.id === 'quest2') q.progress = Math.min(q.target, state.totalClicks);
      }
    });
    renderQuests();
  }

  // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ –ø–æ id
  function completeQuest(id) {
    const q = quests.find(q => q.id === id);
    if(!q) return;
    if(q.progress >= q.target) {
      q.completed = true;
      addLog(`–ö–≤–µ—Å—Ç "${q.title}" –≤—ã–ø–æ–ª–Ω–µ–Ω!`, 'success');
      sounds.achievement.play();
      // –ù–∞–≥—Ä–∞–¥–∞
      for(const [res, val] of Object.entries(q.reward)) {
        state[res] += val;
      }
      updateResources();
      renderQuests();
      checkAchievements();
    } else {
      addLog('–ö–≤–µ—Å—Ç –µ—â—ë –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'error');
    }
  }

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —É–≥–ª—é
  function onCoalClick(e) {
    const activePickaxe = state.inventory[state.activePickaxeIndex];
    const baseGain = activePickaxe.power;

    // –®–∞–Ω—Å –Ω–∞–π—Ç–∏ –∑–æ–ª–æ—Ç–æ–π —É–≥–æ–ª—å (—Ä–µ–¥–∫–∏–π —Ä–µ—Å—É—Ä—Å)
    const goldChance = 0.05; // 5%
    let goldFound = 0;
    let coalFound = baseGain;

    if(Math.random() < goldChance) {
      goldFound = 1;
      coalFound = Math.max(0, coalFound - 1);
    }

    // –®–∞–Ω—Å –Ω–∞–π—Ç–∏ –∫–∞–º–µ–Ω—å (—á–∞—â–µ —á–µ–º –∑–æ–ª–æ—Ç–æ–π —É–≥–æ–ª—å)
    const stoneChance = 0.12; // 12%
    let stonesFound = 0;
    if(Math.random() < stoneChance) stonesFound = 1;

    state.coal += coalFound;
    state.goldCoal += goldFound;
    state.stones += stonesFound;
    state.totalClicks++;

    updateResources();
    checkAchievements();
    checkQuests();

    sounds.click.currentTime = 0;
    sounds.click.play();

    // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
    const rect = coalBtn.getBoundingClientRect();
    const x = e.clientX;
    const y = e.clientY;
    showClickEffect(x, y, `+${coalFound}`);

    if(goldFound) {
      showClickEffect(x + 20, y - 20, '‚ú® +1 –∑–æ–ª–æ—Ç–æ–π —É–≥–æ–ª—å');
      addLog('–¢—ã –Ω–∞—à—ë–ª –∑–æ–ª–æ—Ç–æ–π —É–≥–æ–ª—å! ‚ú®', 'success');
    }
    if(stonesFound) {
      showClickEffect(x - 20, y - 20, 'ü™® +1 –∫–∞–º–µ–Ω—å');
      addLog('–¢—ã –Ω–∞—à—ë–ª –∫–∞–º–µ–Ω—å! ü™®', 'success');
    }

    updatePickaxeInfo();
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  function initGame() {
    addPickaxeToInventory(1); // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –∫–∏—Ä–∫–∞
    addPickaxeToInventory(3); // –≤—Ç–æ—Ä–∏—á–Ω–∞—è –¥–ª—è –≤—ã–±–æ—Ä–∞
    addPickaxeToInventory(5); // –µ—â—ë –æ–¥–Ω–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–µ—Å–∞
    renderInventory();
    updatePickaxeInfo();
    renderAchievements();
    renderQuests();
    updateResources();
  }

  // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
  upgradeBtn.addEventListener('click', upgradePickaxe);
  coalBtn.addEventListener('click', onCoalClick);

  initGame();

  // –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ localStorage (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)
})();
</script>

</body>
</html>

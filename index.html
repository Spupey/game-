<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–£–≥–æ–ª—å–Ω—ã–π –ö–ª–∏–∫–µ—Ä 2.0</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');
  body {
    margin: 0;
    background: #0a0a12;
    color: #e0e7ff;
    font-family: 'Montserrat', sans-serif;
    user-select: none;
    overflow: hidden;
  }
  #game-container {
    display: flex;
    flex-direction: row;
    height: 100vh;
    width: 100vw;
  }
  #left-panel {
    flex: 1;
    position: relative;
    background: radial-gradient(circle at center, #5a5f7f, #0a0a12);
  }
  #canvas {
    display: block;
    margin: auto;
    background: transparent;
    cursor: pointer;
    max-width: 100%;
    max-height: 100vh;
  }
  #right-panel {
    width: 350px;
    background: #121527cc;
    box-shadow: inset 0 0 15px #3957ff99;
    padding: 20px;
    box-sizing: border-box;
    overflow-y: auto;
  }
  h1 {
    margin-top: 0;
    font-weight: 700;
    font-size: 28px;
    text-align: center;
    color: #7db9ff;
  }
  .stat {
    font-size: 18px;
    margin: 8px 0;
    user-select: text;
  }
  button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    margin-top: 10px;
    border: none;
    border-radius: 8px;
    background: #3957ffcc;
    color: #e0e7ff;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:disabled {
    background: #26368088;
    cursor: not-allowed;
  }
  button:hover:not(:disabled) {
    background: #5a82ffcc;
  }
  .upgrade {
    background: #222a44cc;
    border-radius: 10px;
    margin-bottom: 15px;
    padding: 10px;
  }
  .upgrade-title {
    font-weight: 700;
    font-size: 18px;
    margin-bottom: 6px;
  }
  .upgrade-desc {
    font-size: 14px;
    margin-bottom: 8px;
  }
  .combo-text {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    font-weight: 700;
    font-size: 22px;
    color: #7db9ffcc;
    text-shadow: 0 0 8px #3957ffaa;
    user-select: none;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
</style>
</head>
<body>

<div id="game-container">
  <div id="left-panel">
    <canvas id="canvas" width="600" height="400" title="–ö–ª–∏–∫–Ω–∏ –ø–æ —É–≥–ª—é!"></canvas>
    <div id="combo-indicator" class="combo-text">–ö–æ–º–±–æ!</div>
  </div>
  <div id="right-panel">
    <h1>–£–≥–æ–ª—å–Ω—ã–π –ö–ª–∏–∫–µ—Ä 2.0</h1>
    <div class="stat">–£–≥–æ–ª—å: <span id="coal-count">0</span></div>
    <div class="stat">–£–≥–æ–ª—å –∑–∞ –∫–ª–∏–∫: <span id="coal-per-click">1</span></div>
    <div class="stat">–£–≥–æ–ª—å –≤ —Å–µ–∫—É–Ω–¥—É: <span id="coal-per-second">0</span></div>
    <div class="stat">–ö–æ–º–±–æ —Å—á–µ—Ç—á–∏–∫: <span id="combo-count">0</span></div>
    <hr />
    <div class="upgrade">
      <div class="upgrade-title">–ö–∏—Ä–∫–∞ <span id="pickaxe-level">1</span></div>
      <div class="upgrade-desc">–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É–≥–æ–ª—å –∑–∞ –∫–ª–∏–∫</div>
      <button id="buy-pickaxe">–ö—É–ø–∏—Ç—å –∫–∏—Ä–∫—É (+1 —É–≥–æ–ª—å) - –¶–µ–Ω–∞: <span id="pickaxe-price">50</span></button>
    </div>
    <div class="upgrade">
      <div class="upgrade-title">–†–∞–±–æ—á–∏–µ —à–∞—Ö—Ç—ã</div>
      <div class="upgrade-desc">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±—ã–≤–∞—é—Ç —É–≥–æ–ª—å –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫—É–Ω–¥—É</div>
      <button id="buy-miners">–ù–∞–Ω—è—Ç—å —à–∞—Ö—Ç–µ—Ä–æ–≤ (+1 —É–≥–æ–ª—å/—Å–µ–∫) - –¶–µ–Ω–∞: <span id="miners-price">100</span></button>
    </div>
    <div class="upgrade">
      <div class="upgrade-title">–£—Å–∏–ª–∏—Ç–µ–ª—å –∫–ª–∏–∫–æ–≤</div>
      <div class="upgrade-desc">–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É–≥–æ–ª—å –∑–∞ –∫–ª–∏–∫ –Ω–∞ 50% –Ω–∞ 10 —Å–µ–∫—É–Ω–¥</div>
      <button id="boost-clicks" disabled>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–∏–ª–∏—Ç–µ–ª—å (–¶–µ–Ω–∞: 200)</button>
      <div id="boost-timer" style="font-size:14px; margin-top:5px; color:#7db9ff;"></div>
    </div>
  </div>
</div>

<audio id="click-sound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3" preload="auto"></audio>
<audio id="crit-sound" src="https://freesound.org/data/previews/146/146723_2398405-lq.mp3" preload="auto"></audio>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  // –ó–≤—É–∫–∏
  const clickSound = document.getElementById('click-sound');
  const critSound = document.getElementById('crit-sound');
  clickSound.volume = 0.15;
  critSound.volume = 0.15;

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  let coal = 0;
  let coalPerClick = 1;
  let coalPerSecond = 0;
  let comboCount = 0;
  let comboActive = false;
  let comboTimer = null;

  // –ö–∏—Ä–∫–∞
  let pickaxeLevel = 1;
  let pickaxePrice = 50;

  // –®–∞—Ö—Ç–µ—Ä—ã
  let minersCount = 0;
  let minersPrice = 100;

  // –£—Å–∏–ª–∏—Ç–µ–ª—å –∫–ª–∏–∫–æ–≤
  let boostActive = false;
  let boostDuration = 10000; // 10 —Å–µ–∫—É–Ω–¥
  let boostEndTime = 0;
  let boostPrice = 200;

  // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫
  const critChance = 0.15;
  const critMultiplier = 2;

  // –ß–∞—Å—Ç–∏—Ü—ã –∫–ª–∏–∫–∞
  let particles = [];

  // UI —ç–ª–µ–º–µ–Ω—Ç—ã
  const coalCountEl = document.getElementById('coal-count');
  const coalPerClickEl = document.getElementById('coal-per-click');
  const coalPerSecondEl = document.getElementById('coal-per-second');
  const comboCountEl = document.getElementById('combo-count');
  const pickaxeLevelEl = document.getElementById('pickaxe-level');
  const pickaxePriceEl = document.getElementById('pickaxe-price');
  const minersPriceEl = document.getElementById('miners-price');
  const boostClickBtn = document.getElementById('boost-clicks');
  const boostTimerEl = document.getElementById('boost-timer');
  const comboIndicator = document.getElementById('combo-indicator');

  // –í—Å–ø–ª—ã–≤–∞—é—â–∏–π —Ç–µ–∫—Å—Ç –∫–ª–∏–∫–∞
  let clickTexts = [];

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–≤–∞—Å–∞ –∏ –∞–Ω–∏–º–∞—Ü–∏—è
  function createParticle(x, y) {
    return {
      x,
      y,
      size: 8 + Math.random() * 6,
      alpha: 1,
      speedX: (Math.random() - 0.5) * 4,
      speedY: (Math.random() - 1.5) * 4,
      color: `rgba(125, 185, 255,`,
    };
  }

  function showClickText(x, y, text, isCrit = false) {
    clickTexts.push({ x, y, text, alpha: 1, yOffset: 0, isCrit });
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
  function updateUI() {
    coalCountEl.textContent = Math.floor(coal);
    coalPerClickEl.textContent = coalPerClick.toFixed(1);
    coalPerSecondEl.textContent = coalPerSecond.toFixed(1);
    comboCountEl.textContent = comboCount;
    pickaxeLevelEl.textContent = pickaxeLevel;
    pickaxePriceEl.textContent = pickaxePrice;
    minersPriceEl.textContent = minersPrice;
    boostClickBtn.disabled = coal < boostPrice || boostActive;
  }

  // –ü–æ–∫—É–ø–∫–∞ –∫–∏—Ä–∫–∏
  document.getElementById('buy-pickaxe').onclick = () => {
    if (coal >= pickaxePrice) {
      coal -= pickaxePrice;
      pickaxeLevel++;
      coalPerClick += 1;
      pickaxePrice = Math.floor(pickaxePrice * 1.7);
      updateUI();
    }
  };

  // –ü–æ–∫—É–ø–∫–∞ —à–∞—Ö—Ç–µ—Ä–æ–≤
  document.getElementById('buy-miners').onclick = () => {
    if (coal >= minersPrice) {
      coal -= minersPrice;
      minersCount++;
      coalPerSecond += 1;
      minersPrice = Math.floor(minersPrice * 1.5);
      updateUI();
    }
  };

  // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–∏–ª–∏—Ç–µ–ª—å –∫–ª–∏–∫–æ–≤
  boostClickBtn.onclick = () => {
    if (coal >= boostPrice && !boostActive) {
      coal -= boostPrice;
      boostActive = true;
      boostEndTime = Date.now() + boostDuration;
      coalPerClick *= 1.5;
      boostClickBtn.disabled = true;
      updateUI();
    }
  };

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–±–æ-—Å–∏—Å—Ç–µ–º—ã –∏ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–∞–Ω–≤–∞—Å—É
  canvas.onclick = (e) => {
    let rect = canvas.getBoundingClientRect();
    let clickX = e.clientX - rect.left;
    let clickY = e.clientY - rect.top;

    let isCrit = Math.random() < critChance;
    let gain = coalPerClick * (isCrit ? critMultiplier : 1);

    // –ö–æ–º–±–æ –±–æ–Ω—É—Å –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω (5 —Å–µ–∫ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞)
    if (comboActive) {
      gain *= 1.5;
    }

    coal += gain;

    // –ö–æ–º–±–æ –ª–æ–≥–∏–∫–∞
    comboCount++;
    comboActive = true;
    comboIndicator.style.opacity = '1';
    clearTimeout(comboTimer);
    comboTimer = setTimeout(() => {
      comboCount = 0;
      comboActive = false;
      comboIndicator.style.opacity = '0';
      updateUI();
    }, 5000);

    // –ß–∞—Å—Ç–∏—Ü—ã
    for (let i = 0; i < 15; i++) {
      particles.push(createParticle(clickX, clickY));
    }

    // –í—Å–ø–ª—ã–≤–∞—é—â–∏–π —Ç–µ–∫—Å—Ç
    showClickText(clickX, clickY, (isCrit ? `CRIT! +${Math.floor(gain)}` : `+${Math.floor(gain)}`), isCrit);

    // –ó–≤—É–∫–∏
    if (isCrit) {
      critSound.currentTime = 0;
      critSound.play();
    } else {
      clickSound.playbackRate = 0.9 + Math.random() * 0.2;
      clickSound.currentTime = 0;
      clickSound.play();
    }

    updateUI();
  };

  // –ê–≤—Ç–æ–¥–æ–±—ã—á–∞ —É–≥–ª—è —à–∞—Ö—Ç–µ—Ä–∞–º–∏
  setInterval(() => {
    coal += coalPerSecond;
    updateUI();
  }, 1000);

  // –¢–∞–π–º–µ—Ä —É—Å–∏–ª–∏—Ç–µ–ª—è –∫–ª–∏–∫–æ–≤
  function updateBoost() {
    if (boostActive) {
      let remaining = boostEndTime - Date.now();
      if (remaining <= 0) {
        boostActive = false;
        coalPerClick /= 1.5;
        boostTimerEl.textContent = '';
        updateUI();
      } else {
        boostTimerEl.textContent = `–û—Å—Ç–∞–ª–æ—Å—å: ${(remaining / 1000).toFixed(1)} —Å–µ–∫`;
      }
    }
    requestAnimationFrame(updateBoost);
  }
  updateBoost();

  // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // –§–æ–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
    let gradient = ctx.createRadialGradient(canvas.width / 2, canvas.height / 2, 50, canvas.width / 2, canvas.height / 2, 300);
    gradient.addColorStop(0, '#5a5f7f');
    gradient.addColorStop(1, '#0a0a12');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —É–≥–æ–ª—å —Å —Å–≤–µ—á–µ–Ω–∏–µ–º
    ctx.fillStyle = '#3a3affcc';
    ctx.shadowColor = '#7db9ffcc';
    ctx.shadowBlur = 14;
    ctx.fillRect(250, 120, 100, 80);
    ctx.shadowBlur = 0;

    // –≠–º–æ–¥–∑–∏ —É–≥–ª—è
    ctx.fillStyle = '#e0e7ff';
    ctx.font = '72px Montserrat';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('ü™®', canvas.width / 2, canvas.height / 2);

    // –ß–∞—Å—Ç–∏—Ü—ã
    for (let i = particles.length - 1; i >= 0; i--) {
      let p = particles[i];
      ctx.fillStyle = p.color + p.alpha + ')';
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fill();

      p.x += p.speedX;
      p.y += p.speedY;
      p.alpha -= 0.03;
      p.size *= 0.96;

      if (p.alpha <= 0) particles.splice(i, 1);
    }

    // –í—Å–ø–ª—ã–≤–∞—é—â–∏–π —Ç–µ–∫—Å—Ç –∫–ª–∏–∫–∞
    ctx.font = '20px Montserrat';
    ctx.textAlign = 'center';
    for (let i = clickTexts.length - 1; i >= 0; i--) {
      let t = clickTexts[i];
      ctx.fillStyle = t.isCrit ? `rgba(255, 165, 0, ${t.alpha})` : `rgba(125, 185, 255, ${t.alpha})`;
      ctx.fillText(t.text, t.x, t.y - t.yOffset);
      t.alpha -= 0.02;
      t.yOffset += 0.7;
      if (t.alpha <= 0) clickTexts.splice(i, 1);
    }

    requestAnimationFrame(draw);
  }
  draw();

  // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
  updateUI();
</script>

</body>
</html>

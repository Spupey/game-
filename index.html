<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Coal Mine Clicker - –§–∏–Ω–∞–ª</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(135deg, #1a1a1a, #0f0f0f);
    font-family: 'Press Start 2P', cursive;
    color: #eee;
    user-select: none;
  }
  #gameCanvas {
    display: block;
    background: #111;
    margin: 0 auto;
    border: 4px solid #444;
    border-radius: 12px;
    box-shadow: 0 0 25px #0ff inset;
  }
  #ui {
    position: fixed;
    top: 10px;
    left: 10px;
    width: 320px;
    background: rgba(20,20,20,0.85);
    border-radius: 14px;
    padding: 12px;
    box-shadow: 0 0 10px #0ff;
    font-size: 12px;
    z-index: 10;
  }
  #ui h1 {
    margin: 0 0 8px 0;
    font-size: 16px;
    color: #0ff;
    text-align: center;
  }
  #resources, #stats {
    margin-bottom: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: space-between;
  }
  .resource {
    background: #222;
    border-radius: 6px;
    padding: 6px 8px;
    flex: 1 1 45%;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 0 8px #0ff33a44 inset;
    cursor: default;
  }
  .resource img {
    width: 24px;
    height: 24px;
    filter: drop-shadow(0 0 1px #000);
  }
  #buttons {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  button {
    background: linear-gradient(135deg, #0ff3, #00f6);
    border: none;
    padding: 10px;
    color: #000;
    font-weight: 700;
    border-radius: 10px;
    box-shadow: 0 0 12px #0ff7;
    cursor: pointer;
    transition: background 0.3s ease, transform 0.1s ease;
    font-size: 13px;
  }
  button:hover {
    background: linear-gradient(135deg, #0ff7, #0ff9);
    transform: scale(1.05);
  }
  button:active {
    transform: scale(0.98);
  }
  #shop {
    position: fixed;
    top: 150px;
    left: 10px;
    width: 320px;
    background: rgba(10,10,10,0.9);
    padding: 10px;
    border-radius: 14px;
    box-shadow: 0 0 20px #0ff inset;
    display: none;
    flex-direction: column;
    gap: 10px;
    max-height: 60vh;
    overflow-y: auto;
    z-index: 15;
  }
  .shop-item {
    background: #222;
    padding: 10px;
    border-radius: 10px;
    box-shadow: 0 0 12px #0ff5 inset;
    cursor: pointer;
    font-size: 13px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .shop-item:hover {
    background: #0ff2;
    color: #000;
  }
  .shop-item .cost {
    font-weight: 700;
    color: #0a0;
  }
  #quest {
    margin-top: 12px;
    background: #0a0a0a;
    border-radius: 12px;
    padding: 10px;
    box-shadow: inset 0 0 10px #0fa;
    font-size: 13px;
  }
  #quest h2 {
    margin-top: 0;
    color: #0fa;
    font-size: 14px;
  }
  #progressBar {
    width: 100%;
    height: 14px;
    background: #333;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 6px;
  }
  #progressFill {
    height: 100%;
    background: linear-gradient(90deg, #0f0, #0ff);
    border-radius: 10px 0 0 10px;
    width: 0%;
    transition: width 0.4s ease;
  }
  #levelUpMsg {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #0ff9;
    color: #000;
    padding: 20px 40px;
    border-radius: 20px;
    font-weight: 900;
    font-size: 20px;
    box-shadow: 0 0 30px #0ff9;
    opacity: 0;
    pointer-events: none;
    user-select: none;
    transition: opacity 0.5s ease;
    z-index: 20;
  }
  #volumeControl {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    padding: 8px;
    border-radius: 10px;
    box-shadow: 0 0 10px #0ff;
    z-index: 20;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #0ff;
  }
  #volumeControl input[type="range"] {
    width: 100px;
  }
  .icon-small {
    width: 18px;
    height: 18px;
    filter: drop-shadow(0 0 1px #000);
  }
  .click-effect {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
    animation: clickPulse 0.5s ease-out forwards;
    box-shadow: 0 0 10px #0ff8;
  }
  @keyframes clickPulse {
    0% {
      opacity: 1;
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(3);
    }
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="900" height="600"></canvas>

<div id="ui">
  <h1>Coal Mine Clicker</h1>
  <div id="resources">
    <div class="resource" title="–£–≥–æ–ª—å">
      <img src="https://cdn-icons-png.flaticon.com/512/3208/3208721.png" alt="coal" class="icon-small" /> 
      –£–≥–æ–ª—å: <span id="coal-count">0</span>
    </div>
    <div class="resource" title="–ñ–µ–ª–µ–∑–æ">
      <img src="https://cdn-icons-png.flaticon.com/512/1587/1587691.png" alt="iron" class="icon-small" />
      –ñ–µ–ª–µ–∑–æ: <span id="iron-count">0</span>
    </div>
    <div class="resource" title="–ó–æ–ª–æ—Ç–æ">
      <img src="https://cdn-icons-png.flaticon.com/512/2583/2583044.png" alt="gold" class="icon-small" />
      –ó–æ–ª–æ—Ç–æ: <span id="gold-count">0</span>
    </div>
    <div class="resource" title="–ê–ª–º–∞–∑—ã">
      <img src="https://cdn-icons-png.flaticon.com/512/3596/3596152.png" alt="diamond" class="icon-small" />
      –ê–ª–º–∞–∑—ã: <span id="diamond-count">0</span>
    </div>
    <div class="resource" title="–£—Ä–∞–Ω">
      <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" alt="uranium" class="icon-small" />
      –£—Ä–∞–Ω: <span id="uranium-count">0</span>
    </div>
  </div>
  <div id="stats">
    <div class="resource" title="–£—Ä–æ–≤–µ–Ω—å –∫–∏—Ä–∫–∏">
      <img src="https://cdn-icons-png.flaticon.com/512/3069/3069952.png" alt="pickaxe" class="icon-small" />
      –ö–∏—Ä–∫–∞: <span id="pickaxe-level">1</span>
    </div>
    <div class="resource" title="–£—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞">
      üéÆ –£—Ä–æ–≤–µ–Ω—å: <span id="player-level">1</span>
    </div>
    <div class="resource" title="–û–ø—ã—Ç">
      üåü –û–ø—ã—Ç: <span id="xp-count">0</span>
    </div>
  </div>

  <div id="buttons">
    <button id="upgrade-btn">üî® –£–ª—É—á—à–∏—Ç—å –∫–∏—Ä–∫—É (—Å—Ç–æ–∏–º–æ—Å—Ç—å: <span id="upgrade-cost">10</span> —É–≥–ª—è)</button>
    <button id="shop-toggle-btn">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
  </div>

  <div id="quest">
    <h2>–ó–∞–¥–∞–Ω–∏–µ</h2>
    <div id="quest-text">–î–æ–±—É–¥—å—Ç–µ 100 —É–≥–ª—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å!</div>
    <div id="progressBar"><div id="progressFill"></div></div>
  </div>
</div>

<div id="shop">
  <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
  <div class="shop-item" data-item="autoMiner">
    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —à–∞—Ö—Ç—ë—Ä <span class="cost" id="autoMiner-cost">50 —É–≥–ª—è</span>
  </div>
  <div class="shop-item" data-item="explosives">
    –í–∑—Ä—ã–≤—á–∞—Ç–∫–∞ (—É–º–Ω–æ–∂–∞–µ—Ç –¥–æ–±—ã—á—É) <span class="cost" id="explosives-cost">200 –∑–æ–ª–æ—Ç–∞</span>
  </div>
  <div class="shop-item" data-item="gemFinder">
    –ü–æ–∏—Å–∫–æ–≤–∏–∫ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã—Ö –∫–∞–º–Ω–µ–π <span class="cost" id="gemFinder-cost">500 –∞–ª–º–∞–∑–æ–≤</span>
  </div>
  <div class="shop-item" data-item="uraniumDrill">
    –£—Ä–∞–Ω–æ–≤–∞—è –¥—Ä–µ–ª—å <span class="cost" id="uraniumDrill-cost">1000 —É—Ä–∞–Ω–∞</span>
  </div>
  <button id="close-shop-btn">–ó–∞–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
</div>

<div id="levelUpMsg">–£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! üéâ</div>

<div id="volumeControl">
  üîà –ì—Ä–æ–º–∫–æ—Å—Ç—å: <input type="range" min="0" max="1" step="0.01" id="volumeSlider" value="0.3" />
</div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  // –ó–≤—É–∫–∏
  const sounds = {
    mine: new Audio('https://freesound.org/data/previews/82/82382_1022650-lq.mp3'),
    levelUp: new Audio('https://freesound.org/data/previews/331/331912_3248244-lq.mp3'),
    click: new Audio('https://freesound.org/data/previews/65/65952_634166-lq.mp3'),
  };

  for (const s in sounds) {
    sounds[s].volume = 0.3;
  }

  const volumeSlider = document.getElementById('volumeSlider');
  volumeSlider.addEventListener('input', () => {
    const vol = parseFloat(volumeSlider.value);
    for (const s in sounds) {
      sounds[s].volume = vol;
    }
  });

  // –ò–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  let resources = {
    coal: 0,
    iron: 0,
    gold: 0,
    diamond: 0,
    uranium: 0
  };

  let pickaxeLevel = 1;
  let pickaxePower = 1;
  let playerLevel = 1;
  let playerXP = 0;
  let xpToLevelUp = 100;
  let autoMiners = 0;
  let explosives = 0; // –º–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ–±—ã—á–∏
  let gemFinder = 0;  // —à–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã—Ö –∫–∞–º–Ω–µ–π
  let uraniumDrill = 0; // —à–∞–Ω—Å –¥–æ–±—ã—á–∏ —É—Ä–∞–Ω–∞

  // –ö–≤–µ—Å—Ç—ã
  let quest = {
    goal: 100,
    resource: 'coal',
    rewardXP: 50
  };

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  function updateUI() {
    document.getElementById('coal-count').textContent = Math.floor(resources.coal);
    document.getElementById('iron-count').textContent = Math.floor(resources.iron);
    document.getElementById('gold-count').textContent = Math.floor(resources.gold);
    document.getElementById('diamond-count').textContent = Math.floor(resources.diamond);
    document.getElementById('uranium-count').textContent = Math.floor(resources.uranium);
    document.getElementById('pickaxe-level').textContent = pickaxeLevel;
    document.getElementById('player-level').textContent = playerLevel;
    document.getElementById('xp-count').textContent = playerXP + ' / ' + xpToLevelUp;
    document.getElementById('upgrade-cost').textContent = Math.floor(10 * Math.pow(1.7, pickaxeLevel - 1));

    // –ö–≤–µ—Å—Ç
    const progressPercent = Math.min(100, (resources[quest.resource] / quest.goal) * 100);
    document.getElementById('progressFill').style.width = progressPercent + '%';
    if(progressPercent >= 100) {
      document.getElementById('quest-text').textContent = `–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ü–æ–ª—É—á–∏—Ç–µ ${quest.rewardXP} –æ–ø—ã—Ç–∞ –∏ –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ!`;
    } else {
      document.getElementById('quest-text').textContent = `–î–æ–±—É–¥—å—Ç–µ ${quest.goal} ${quest.resource}, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å!`;
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –∏–≥—Ä–æ–∫–∞
  function tryLevelUp() {
    if(playerXP >= xpToLevelUp) {
      playerXP -= xpToLevelUp;
      playerLevel++;
      xpToLevelUp = Math.floor(xpToLevelUp * 1.5);
      showLevelUpMsg();
      sounds.levelUp.play();
    }
  }

  // –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Ä–æ–≤–Ω–µ
  const levelUpMsg = document.getElementById('levelUpMsg');
  let levelUpTimeout = null;
  function showLevelUpMsg() {
    levelUpMsg.style.opacity = '1';
    if(levelUpTimeout) clearTimeout(levelUpTimeout);
    levelUpTimeout = setTimeout(() => {
      levelUpMsg.style.opacity = '0';
    }, 2000);
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–æ–±—ã—á–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –∫–ª–∏–∫–µ
  function mine() {
    sounds.mine.currentTime = 0;
    sounds.mine.play();

    let baseAmount = pickaxePower;

    // –í–∑—Ä—ã–≤—á–∞—Ç–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ–±—ã—á—É
    baseAmount *= (1 + explosives * 0.5);

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–µ—Å—É—Ä—Å—ã —Å —à–∞–Ω—Å–æ–º –Ω–∞ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–µ –∫–∞–º–Ω–∏ –∏ —É—Ä–∞–Ω
    resources.coal += baseAmount * 0.7;
    resources.iron += baseAmount * 0.15;

    if(Math.random() < gemFinder * 0.1) {
      resources.diamond += 1;
      spawnFloatingText('+üíé', 'diamond');
    }

    if(Math.random() < uraniumDrill * 0.05) {
      resources.uranium += 1;
      spawnFloatingText('+‚ò¢Ô∏è', 'uranium');
    }

    // –†–µ–¥–∫–∏–π —à–∞–Ω—Å –Ω–∞ –∑–æ–ª–æ—Ç–æ
    if(Math.random() < 0.05) {
      resources.gold += 1;
      spawnFloatingText('+ü•á', 'gold');
    }

    // –û–ø—ã—Ç –∏ –∫–≤–µ—Å—Ç—ã
    playerXP += Math.floor(baseAmount * 2);
    checkQuest();

    updateUI();
    tryLevelUp();
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–µ—Å—Ç–∞
  function checkQuest() {
    if(resources[quest.resource] >= quest.goal) {
      playerXP += quest.rewardXP;
      quest.goal = Math.floor(quest.goal * 1.7 + 50);
      quest.rewardXP = Math.floor(quest.rewardXP * 1.3);
      // –†–∞–Ω–¥–æ–º–Ω–æ –º–µ–Ω—è–µ–º —Ä–µ—Å—É—Ä—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–≤–µ—Å—Ç–∞
      const resKeys = Object.keys(resources);
      quest.resource = resKeys[Math.floor(Math.random() * resKeys.length)];
      updateUI();
      showLevelUpMsg();
      sounds.levelUp.play();
    }
  }

  // –£–ª—É—á—à–µ–Ω–∏–µ –∫–∏—Ä–∫–∏
  function upgradePickaxe() {
    const cost = Math.floor(10 * Math.pow(1.7, pickaxeLevel - 1));
    if(resources.coal >= cost) {
      resources.coal -= cost;
      pickaxeLevel++;
      pickaxePower = 1 + pickaxeLevel * 0.7;
      updateUI();
      spawnFloatingText('üî® –ö–∏—Ä–∫–∞ —É–ª—É—á—à–µ–Ω–∞!', 'pickaxe');
      sounds.click.play();
    } else {
      spawnFloatingText('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–≥–ª—è!', 'coal');
    }
  }

  // –ú–∞–≥–∞–∑–∏–Ω
  const shop = document.getElementById('shop');
  const shopToggleBtn = document.getElementById('shop-toggle-btn');
  const closeShopBtn = document.getElementById('close-shop-btn');

  shopToggleBtn.addEventListener('click', () => {
    shop.style.display = shop.style.display === 'flex' ? 'none' : 'flex';
  });

  closeShopBtn.addEventListener('click', () => {
    shop.style.display = 'none';
  });

  // –ü–æ–∫—É–ø–∫–∞ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞
  shop.querySelectorAll('.shop-item').forEach(item => {
    item.addEventListener('click', () => {
      const itemType = item.dataset.item;
      if(itemType === 'autoMiner') {
        if(resources.coal >= 50) {
          resources.coal -= 50;
          autoMiners++;
          spawnFloatingText('ü§ñ –ê–≤—Ç–æ—à–∞—Ö—Ç—ë—Ä –∫—É–ø–ª–µ–Ω!', 'coal');
          updateUI();
        } else {
          spawnFloatingText('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–≥–ª—è!', 'coal');
        }
      }
      else if(itemType === 'explosives') {
        if(resources.gold >= 200) {
          resources.gold -= 200;
          explosives++;
          spawnFloatingText('üí• –í–∑—Ä—ã–≤—á–∞—Ç–∫–∞ –∫—É–ø–ª–µ–Ω–∞!', 'gold');
          updateUI();
        } else {
          spawnFloatingText('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞!', 'gold');
        }
      }
      else if(itemType === 'gemFinder') {
        if(resources.diamond >= 500) {
          resources.diamond -= 500;
          gemFinder++;
          spawnFloatingText('üíé –ü–æ–∏—Å–∫–æ–≤–∏–∫ –∫—É–ø–ª–µ–Ω!', 'diamond');
          updateUI();
        } else {
          spawnFloatingText('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–ª–º–∞–∑–æ–≤!', 'diamond');
        }
      }
      else if(itemType === 'uraniumDrill') {
        if(resources.uranium >= 1000) {
          resources.uranium -= 1000;
          uraniumDrill++;
          spawnFloatingText('‚ò¢Ô∏è –£—Ä–∞–Ω–æ–≤–∞—è –¥—Ä–µ–ª—å –∫—É–ø–ª–µ–Ω–∞!', 'uranium');
          updateUI();
        } else {
          spawnFloatingText('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Ä–∞–Ω–∞!', 'uranium');
        }
      }
    });
  });

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–±—ã—á–∞
  setInterval(() => {
    if(autoMiners > 0) {
      resources.coal += autoMiners * pickaxePower * 0.5 * (1 + explosives * 0.5);
      playerXP += autoMiners * 2;
      checkQuest();
      updateUI();
      tryLevelUp();
    }
  }, 3000);

  // –ö–ª–∏–∫–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã
  canvas.addEventListener('click', (e) => {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    createClickEffect(x, y);
    mine();
  });

  // –≠—Ñ—Ñ–µ–∫—Ç—ã –∫–ª–∏–∫–∞
  function createClickEffect(x, y) {
    const effect = document.createElement('div');
    effect.className = 'click-effect';
    effect.style.left = (x - 10) + 'px';
    effect.style.top = (y - 10) + 'px';
    effect.style.width = '20px';
    effect.style.height = '20px';
    document.body.appendChild(effect);
    setTimeout(() => {
      effect.remove();
    }, 500);
  }

  // –¢–µ–∫—Å—Ç—ã –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ
  function spawnFloatingText(text, type) {
    const colors = {
      coal: '#5555ff',
      iron: '#888888',
      gold: '#ffd700',
      diamond: '#00ffff',
      uranium: '#55ff55',
      pickaxe: '#ffaa00'
    };
    const fx = document.createElement('div');
    fx.textContent = text;
    fx.style.position = 'fixed';
    fx.style.left = (window.innerWidth / 2 + (Math.random() * 100 - 50)) + 'px';
    fx.style.top = (window.innerHeight / 2 + (Math.random() * 50 - 25)) + 'px';
    fx.style.color = colors[type] || '#fff';
    fx.style.fontWeight = 'bold';
    fx.style.fontSize = '18px';
    fx.style.textShadow = '0 0 5px #000';
    fx.style.pointerEvents = 'none';
    fx.style.userSelect = 'none';
    fx.style.opacity = '1';
    fx.style.transition = 'transform 1.5s ease, opacity 1.5s ease';
    document.body.appendChild(fx);
    setTimeout(() => {
      fx.style.transform = 'translateY(-80px)';
      fx.style.opacity = '0';
    }, 50);
    setTimeout(() => {
      fx.remove();
    }, 1600);
  }

  // –†–µ–Ω–¥–µ—Ä —à–∞—Ö—Ç—ã (—Ñ–æ–Ω + –∞–Ω–∏–º–∞—Ü–∏—è)
  let mineBgGradient;
  function renderMine() {
    // –§–æ–Ω —à–∞—Ö—Ç—ã —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
    mineBgGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
    mineBgGradient.addColorStop(0, '#2c3e50');
    mineBgGradient.addColorStop(0.7, '#000000');
    mineBgGradient.addColorStop(1, '#111');

    ctx.fillStyle = mineBgGradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // –ö–∞–º–Ω–∏ –∏ —É–≥–æ–ª—å - —Ä–∞–Ω–¥–æ–º–Ω—ã–µ –∫—Ä—É–∂–∫–∏
    for(let i=0; i<50; i++) {
      const x = (i * 18 + (Math.sin(Date.now() / 1000 + i) * 5)) % canvas.width;
      const y = 100 + (i * 12) % (canvas.height - 100);
      ctx.beginPath();
      ctx.fillStyle = 'rgba(40,40,40,0.5)';
      ctx.arc(x, y, 7 + (Math.sin(Date.now() / 700 + i)*3), 0, Math.PI*2);
      ctx.fill();

      // –£–≥–æ–ª—å (—á–µ—Ä–Ω—ã–µ –∫—Ä—É–∂–æ—á–∫–∏)
      ctx.beginPath();
      ctx.fillStyle = 'rgba(20,20,20,0.9)';
      ctx.arc(x+3, y+3, 5 + (Math.cos(Date.now() / 800 + i)*2), 0, Math.PI*2);
      ctx.fill();
    }

    // –ö–∏—Ä–∫–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–Ω–∏–∑—É
    const pickaxeImg = new Image();
    pickaxeImg.src = 'https://cdn-icons-png.flaticon.com/512/3069/3069952.png';
    ctx.drawImage(pickaxeImg, canvas.width / 2 - 24, canvas.height - 70, 48, 48);

    // –ò–Ω–¥–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è –∫–∏—Ä–∫–∏
    ctx.fillStyle = '#0ff';
    ctx.font = 'bold 18px "Press Start 2P"';
    ctx.textAlign = 'center';
    ctx.fillText('–ö–∏—Ä–∫–∞ —É—Ä. ' + pickaxeLevel, canvas.width / 2, canvas.height - 20);
  }

  // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∞–Ω–∏–º–∞—Ü–∏–∏
  function gameLoop() {
    renderMine();
    requestAnimationFrame(gameLoop);
  }

  // –ö–Ω–æ–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è –∫–∏—Ä–∫–∏
  document.getElementById('upgrade-btn').addEventListener('click', upgradePickaxe);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI –∏ –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
  updateUI();
  gameLoop();

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ localStorage –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
  function saveProgress() {
    const save = {
      resources,
      pickaxeLevel,
      pickaxePower,
      playerLevel,
      playerXP,
      xpToLevelUp,
      autoMiners,
      explosives,
      gemFinder,
      uraniumDrill,
      quest
    };
    localStorage.setItem('coalMineClickerSave', JSON.stringify(save));
  }

  // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
  function loadProgress() {
    const save = JSON.parse(localStorage.getItem('coalMineClickerSave'));
    if(save) {
      Object.assign(resources, save.resources);
      pickaxeLevel = save.pickaxeLevel;
      pickaxePower = save.pickaxePower;
      playerLevel = save.playerLevel;
      playerXP = save.playerXP;
      xpToLevelUp = save.xpToLevelUp;
      autoMiners = save.autoMiners;
      explosives = save.explosives;
      gemFinder = save.gemFinder;
      uraniumDrill = save.uraniumDrill;
      quest = save.quest;
      updateUI();
    }
  }

  loadProgress();
  setInterval(saveProgress, 60000);

})();
</script>

</body>
</html>
